<div class="product-offerings">
  <h2 class="section-title">Our Products</h2>

  <div id="product-grid" class="product-grid">
    <!-- Placeholder for products, will be populated by JavaScript -->
    <div class="product-placeholder"></div>
    <div class="product-placeholder"></div>
    <div class="product-placeholder"></div>
  </div>

  <div id="product-modal" class="modal">
    <div class="modal-content">
      <button id="close-modal" class="close-button" aria-label="Close modal">&times;</button>
      <div class="modal-body">
        <img id="modal-image" src="" alt="">
        <h3 id="modal-title"></h3>
        <p id="modal-description"></p>
      </div>
    </div>
  </div>

  <div class="button-container">
    <button id="more-products-btn" class="product-button">Show More Products</button>
  </div>
</div>

<style>
/* Base styles */
.product-offerings {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem 1rem;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* Section title */
.section-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: #333;
  margin-bottom: 2rem;
  text-align: center;
  position: relative;
}

.section-title:after {
  content: '';
  position: absolute;
  bottom: -0.5rem;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, #6366F1, #8B5CF6);
  border-radius: 2px;
}

/* Product grid */
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 2rem;
  margin-bottom: 2.5rem;
}

/* Product card */
.product-card {
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
  cursor: pointer;
}

.product-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
}

.product-image-container {
  position: relative;
  padding-top: 66%; /* Maintain aspect ratio */
  overflow: hidden;
  background: #f5f5f5;
}

.product-image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.product-card:hover .product-image {
  transform: scale(1.05);
}

.product-info {
  padding: 1.5rem;
}

.product-title {
  font-size: 1.5rem;
  font-weight: 600;
  color: #4338ca;
  margin: 0 0 0.5rem;
}

/* Placeholder styles */
.product-placeholder {
  background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
  border-radius: 12px;
  height: 300px;
  animation: shimmer 1.5s infinite linear;
  background-size: 200% 100%;
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

/* Modal styles */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.modal.show {
  display: flex;
  opacity: 1;
}

.modal-content {
  background-color: #fff;
  border-radius: 12px;
  width: 90%;
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
  transform: translateY(20px);
  transition: transform 0.3s ease;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
}

.modal.show .modal-content {
  transform: translateY(0);
}

.modal-body {
  padding: 2rem;
}

.close-button {
  position: absolute;
  top: 1rem;
  right: 1rem;
  font-size: 2rem;
  background: none;
  border: none;
  color: #666;
  cursor: pointer;
  z-index: 10;
  transition: color 0.2s;
}

.close-button:hover {
  color: #333;
}

#modal-image {
  width: 100%;
  border-radius: 8px;
  margin-bottom: 1.5rem;
}

#modal-title {
  font-size: 2rem;
  color: #4338ca;
  margin-top: 0;
  margin-bottom: 1rem;
}

#modal-description {
  font-size: 1.1rem;
  line-height: 1.6;
  color: #444;
}

/* Button styles */
.button-container {
  text-align: center;
  margin-top: 2rem;
}

.product-button {
  background: linear-gradient(90deg, #6366F1, #8B5CF6);
  color: white;
  border: none;
  padding: 1rem 2.5rem;
  font-size: 1.1rem;
  font-weight: 600;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(107, 114, 239, 0.3);
}

.product-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 7px 20px rgba(107, 114, 239, 0.4);
}

.product-button:active {
  transform: translateY(1px);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .section-title {
    font-size: 2rem;
  }

  .product-title {
    font-size: 1.3rem;
  }

  #modal-title {
    font-size: 1.7rem;
  }

  .product-button {
    padding: 0.8rem 2rem;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .product-grid {
    grid-template-columns: 1fr;
  }

  .section-title {
    font-size: 1.8rem;
  }

  .modal-body {
    padding: 1.5rem;
  }
}

/* Animation for new products */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in {
  animation: fadeIn 0.5s ease forwards;
}
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // DOM elements
    const productGrid = document.getElementById('product-grid');
    const modal = document.getElementById('product-modal');
    const modalImage = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalDescription = document.getElementById('modal-description');
    const closeModalBtn = document.getElementById('close-modal');
    const moreProductsBtn = document.getElementById('more-products-btn');

    // Product data
    const productData = {
      descriptions: {
        'alerts': 'Set up real-time monitors for any metric in your environment and get instantly notified when issues arise. Our alert system offers customizable thresholds, intelligent anomaly detection, and integrates with all major notification channels including email, SMS, Slack, and PagerDuty.',
        'application-performance-monitoring': 'Get comprehensive insights into your application performance with end-to-end transaction tracing, code-level visibility, and automatic bottleneck identification. Identify and resolve performance issues before they impact users, with custom dashboards showing the metrics that matter most to your business.',
        'database-monitoring': 'Monitor your database performance, queries, and health metrics in real-time with our powerful database monitoring solution. Track query execution time, resource utilization, connection pools, and get recommendations for optimization to ensure your databases are always running efficiently.',
        'log-management': 'Centralize, analyze, and monitor all your log data in one place with our advanced log management system. Easily search across billions of log events, create custom dashboards, set up alerts on log patterns, and retain your logs for compliance and troubleshooting needs.',
        'observability-pipelines': 'Build flexible observability data pipelines to collect, transform, filter, and route metrics, logs, and traces throughout your infrastructure. Reduce observability data volume and costs while ensuring the right data gets to the right destinations.',
        'real-user-monitoring': 'Understand exactly how real users experience your web applications with detailed performance metrics, session recordings, and user journey analytics. Identify UX issues, track conversion impacts, and optimize performance across different browsers, devices, and geographic locations.'
      },
      items: [
        { name: 'alerts.png' },
        { name: 'application-performance-monitoring.png' },
        { name: 'database-monitoring.png' },
        { name: 'log-management.png' },
        { name: 'observability-pipelines.png' },
        { name: 'real-user-monitoring.png' }
      ]
    };

    // Helper functions
    const formatProductName = name => {
      return name
        .replace('.png', '')
        .split('-')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ');
    };

    const showModal = (product, name) => {
      modalImage.src = `/images/${product.name}`;
      modalImage.alt = name;
      modalTitle.textContent = formatProductName(name);
      modalDescription.textContent = productData.descriptions[name.replace('.png', '')] || 'Product details coming soon.';

      // Show modal with animation
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent scrolling

      // Focus trap for accessibility
      setTimeout(() => closeModalBtn.focus(), 100);

      // Send custom event to Datadog RUM
      if (window.DD_RUM) {
        window.DD_RUM.addAction('view_product_details', {
          product_name: formatProductName(name),
          product_id: name.replace('.png', '')
        });
      }
    };

    const hideModal = () => {
      modal.classList.remove('show');
      document.body.style.overflow = ''; // Restore scrolling

      // Send custom event to Datadog RUM
      if (window.DD_RUM) {
        window.DD_RUM.addAction('close_product_modal', {});
      }
    };

    const createProductCard = (product, index) => {
      const productName = product.name.split('.')[0];
      const productCard = document.createElement('div');
      productCard.className = 'product-card fade-in';
      productCard.style.animationDelay = `${index * 0.1}s`;

      productCard.innerHTML = `
        <div class="product-image-container">
          <img src="/images/${product.name}" alt="${productName}" class="product-image">
        </div>
        <div class="product-info">
          <h3 class="product-title">${formatProductName(productName)}</h3>
        </div>
      `;

      productCard.addEventListener('click', () => showModal(product, product.name));
      return productCard;
    };

    // Initialize product grid
    const initProductGrid = (items = productData.items.slice(0, 3)) => {
      productGrid.innerHTML = '';

      items.forEach((product, index) => {
        const productCard = createProductCard(product, index);
        productGrid.appendChild(productCard);
      });
    };

    // Event listeners
    let isGridExpanded = false;

    moreProductsBtn.addEventListener('click', () => {
      if (!isGridExpanded) {
        initProductGrid(productData.items); // Show all products
        moreProductsBtn.textContent = "Show Less";

        // Send custom event to Datadog RUM
        if (window.DD_RUM) {
          window.DD_RUM.addAction('show_more_products', {
            total_products: productData.items.length
          });
        }
      } else {
        initProductGrid(productData.items.slice(0, 3)); // Show only first 3 products
        moreProductsBtn.textContent = "Show More Products";

        // Send custom event to Datadog RUM
        if (window.DD_RUM) {
          window.DD_RUM.addAction('show_fewer_products', {});
        }
      }
      isGridExpanded = !isGridExpanded;
    });

    closeModalBtn.addEventListener('click', hideModal);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) hideModal();
    });

    // Keyboard accessibility
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.classList.contains('show')) {
        hideModal();
      }
    });

    // Touch devices - add swipe down to close
    let touchStartY = 0;
    let touchEndY = 0;

    modal.addEventListener('touchstart', (e) => {
      touchStartY = e.changedTouches[0].screenY;
    });

    modal.addEventListener('touchend', (e) => {
      touchEndY = e.changedTouches[0].screenY;
      if (touchEndY - touchStartY > 50) { // Swipe down
        hideModal();
      }
    });

    // Initialize
    initProductGrid();
  });
</script>